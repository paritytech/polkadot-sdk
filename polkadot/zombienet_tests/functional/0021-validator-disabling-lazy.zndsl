Description: Test validator disabling effects
Network: ./0021-validator-disabling-lazy.toml
Creds: config

# Ensure nodes are up and running
honest-validator: reports node_roles is 4

# Ensure parachain is registered
honest-validator: parachain 1000 is registered within 100 seconds

# Ensure parachain made progress
honest-validator: parachain 1000 block height is at least 5 within 300 seconds

# Wait for the dispute
honest-validator-1: reports parachain_candidate_disputes_total is at least 1 within 300 seconds

# Verify dispute votes
honest-validator: reports polkadot_parachain_candidate_dispute_votes{validity="valid"} is at least 1 within 90 seconds
malus-approving-validator: reports polkadot_parachain_candidate_dispute_votes{validity="invalid"} is at least 1 within 90 seconds

# Disputes should conclude
honest-validator: reports polkadot_parachain_candidate_dispute_concluded{validity="invalid"} is at least 1 within 300 seconds
honest-validator: reports polkadot_parachain_candidate_dispute_concluded{validity="valid"} is 0 within 50 seconds

# Wait for a few blocks for the disabling to take place.
honest-validator: log line contains "Disabled validators detected" within 180 seconds
