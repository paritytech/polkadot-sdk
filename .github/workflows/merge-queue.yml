name: Merge-Queue

on:
  merge_group:

jobs:
  trigger-merge-queue-action:
    runs-on: ubuntu-latest
    environment: master
    steps:
      - name: Generate token
        id: app_token
        uses: tibdex/github-app-token@v1
        with:
          app_id: ${{ secrets.REVIEW_APP_ID }}
          private_key: ${{ secrets.REVIEW_APP_KEY }}
      - name: Add Merge Queue status check
        uses: billyjbryant/create-status-check@v2
        with:
          authToken: ${{ steps.app_token.outputs.token }}
          context: 'review-bot'
          description: 'PRs for merge queue gets approved'
          state: 'success'
          sha: ${{ github.event.merge_group.head_commit.id }}
