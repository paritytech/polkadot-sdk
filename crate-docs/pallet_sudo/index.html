<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Made with Substrate, for Polkadot."><title>pallet_sudo - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-cb6f1f67f1bcd037.css" id="mainThemeStyle"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="pallet_sudo" data-themes="" data-resource-suffix="" data-rustdoc-version="1.73.0 (cc66ad468 2023-10-03)" data-channel="1.73.0" data-search-js="search-6dfdfced5eff6596.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-1596385f77d47ef2.css" data-theme-dark-css="dark-0a43001d3fc2282c.css" data-theme-ayu-css="ayu-fd19013d6ce078bf.css" ><script src="../static.files/storage-db41da1a38ea3cb8.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-0795b7d26be81095.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../static.files/light-1596385f77d47ef2.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../static.files/dark-0a43001d3fc2282c.css"><link rel="stylesheet" href="../static.files/noscript-cffde32267a19fd6.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"><script async defer src="https://apisa.parity.io/latest.js"></script><noscript><img src="https://apisa.parity.io/latest.js" alt="" referrerpolicy="no-referrer-when-downgrade" /></noscript></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../pallet_sudo/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../pallet_sudo/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Crate pallet_sudo</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 4.0.0-dev</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#reexports">Re-exports</a></li><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">pallet_sudo</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../src/pallet_sudo/lib.rs.html#18-353">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><blockquote>
<p>Made with <em>Substrate</em>, for <em>Polkadot</em>.</p>
</blockquote>
<p><a href="https://github.com/paritytech/polkadot-sdk/tree/master/substrate/frame/sudo"><img src="https://img.shields.io/badge/github-8da0cb?style=for-the-badge&amp;labelColor=555555&amp;logo=github" alt="github" /></a>
<a href="https://polkadot.network"><img src="https://img.shields.io/badge/polkadot-E6007A?style=for-the-badge&amp;logo=polkadot&amp;logoColor=white" alt="polkadot" /></a></p>
<h2 id="sudo-pallet"><a href="#sudo-pallet">Sudo Pallet</a></h2>
<p>A pallet to provide a way to execute privileged runtime calls using a specified sudo (“superuser
do”) account.</p>
<h3 id="pallet-api"><a href="#pallet-api">Pallet API</a></h3>
<p>See the <a href="pallet/index.html" title="mod pallet_sudo::pallet"><code>pallet</code></a> module for more information about the interfaces this pallet exposes,
including its configuration trait, dispatchables, storage items, events and errors.</p>
<h3 id="overview"><a href="#overview">Overview</a></h3>
<p>In Substrate blockchains, pallets may contain dispatchable calls that can only be called at
the system level of the chain (i.e. dispatchables that require a <code>Root</code> origin).
Setting a privileged account, called the <em>sudo key</em>, allows you to make such calls as an
extrinisic.</p>
<p>Here’s an example of a privileged function in another pallet:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="attr">#[frame_support::pallet]
</span><span class="kw">pub mod </span>pallet {
	<span class="kw">use super</span>::<span class="kw-2">*</span>;
	<span class="kw">use </span>frame_support::pallet_prelude::<span class="kw-2">*</span>;
	<span class="kw">use </span>frame_system::pallet_prelude::<span class="kw-2">*</span>;

	<span class="attr">#[pallet::pallet]
	</span><span class="kw">pub struct </span>Pallet&lt;T&gt;(<span class="kw">_</span>);

	<span class="attr">#[pallet::config]
	</span><span class="kw">pub trait </span>Config: frame_system::Config {}

	<span class="attr">#[pallet::call]
	</span><span class="kw">impl</span>&lt;T: Config&gt; Pallet&lt;T&gt; {
		<span class="attr">#[pallet::weight(<span class="number">0</span>)]
        </span><span class="kw">pub fn </span>privileged_function(origin: OriginFor&lt;T&gt;) -&gt; DispatchResult {
            ensure_root(origin)<span class="question-mark">?</span>;

            <span class="comment">// do something...

            </span><span class="prelude-val">Ok</span>(())
        }
	}
}</code></pre></div>
<p>With the Sudo pallet configured in your chain’s runtime you can execute this privileged
function by constructing a call using the <a href="pallet/struct.Pallet.html#method.sudo" title="associated function pallet_sudo::pallet::Pallet::sudo"><code>sudo</code></a> dispatchable.</p>
<p>To use this pallet in your runtime, a sudo key must be specified in the <a href="pallet/struct.GenesisConfig.html" title="struct pallet_sudo::pallet::GenesisConfig"><code>GenesisConfig</code></a> of
the pallet. You can change this key at anytime once your chain is live using the
<a href="pallet/struct.Pallet.html#method.set_key" title="associated function pallet_sudo::pallet::Pallet::set_key"><code>set_key</code></a> dispatchable, however <strong>only one sudo key can be set at a
time</strong>. The pallet also allows you to make a call using
<a href="pallet/struct.Pallet.html#method.sudo_unchecked_weight" title="associated function pallet_sudo::pallet::Pallet::sudo_unchecked_weight"><code>sudo_unchecked_weight</code></a>, which allows the sudo account to
execute a call with a custom weight.</p>
<div class="example-wrap" style="display:inline-block"><pre class="compile_fail"
style="white-space:normal;font:inherit;">
<strong>Note:</strong> this pallet is not meant to be used inside other pallets. It is only
meant to be used by constructing runtime calls from outside the runtime.
</pre></div>
<p>This pallet also defines a <a href="../sp_runtime/traits/trait.SignedExtension.html" title="trait sp_runtime::traits::SignedExtension"><code>SignedExtension</code></a> called
<a href="struct.CheckOnlySudoAccount.html" title="struct pallet_sudo::CheckOnlySudoAccount"><code>CheckOnlySudoAccount</code></a> to ensure that only signed transactions by the sudo account are
accepted by the transaction pool. The intended use of this signed extension is to prevent other
accounts from spamming the transaction pool for the initial phase of a chain, during which
developers may only want a sudo account to be able to make transactions.</p>
<p>Learn more about the <code>Root</code> origin in the <a href="../frame_support/dispatch/enum.RawOrigin.html" title="enum frame_support::dispatch::RawOrigin"><code>RawOrigin</code></a> type
documentation.</p>
<h4 id="examples"><a href="#examples">Examples</a></h4>
<ol>
<li>You can make a privileged runtime call using <code>sudo</code> with an account that matches the sudo
key.</li>
</ol>

<div class="example-wrap ignore"><a href="#" class="tooltip" title="This example is not tested">ⓘ</a><pre class="rust rust-example-rendered"><code><span class="attr">#[test]
</span><span class="kw">fn </span>sudo_basics() {
	<span class="comment">// Configure a default test environment and set the root `key` to 1.
	</span>new_test_ext(<span class="number">1</span>).execute_with(|| {
		<span class="comment">// A privileged function should work when `sudo` is passed the root `key` as `origin`.
		</span><span class="kw">let </span>call = Box::new(RuntimeCall::Logger(LoggerCall::privileged_i32_log {
			i: <span class="number">42</span>,
			weight: Weight::from_parts(<span class="number">1_000</span>, <span class="number">0</span>),
		}));
		<span class="macro">assert_ok!</span>(Sudo::sudo(RuntimeOrigin::signed(<span class="number">1</span>), call));
		<span class="macro">assert_eq!</span>(Logger::i32_log(), <span class="macro">vec!</span>[<span class="number">42i32</span>]);

		<span class="comment">// A privileged function should not work when `sudo` is passed a non-root `key` as `origin`.
		</span><span class="kw">let </span>call = Box::new(RuntimeCall::Logger(LoggerCall::privileged_i32_log {
			i: <span class="number">42</span>,
			weight: Weight::from_parts(<span class="number">1_000</span>, <span class="number">0</span>),
		}));
		<span class="macro">assert_noop!</span>(Sudo::sudo(RuntimeOrigin::signed(<span class="number">2</span>), call), Error::&lt;Test&gt;::RequireSudo);
	});
}</code></pre></div>
<ol start="2">
<li>Only an existing sudo key can set a new one.</li>
</ol>

<div class="example-wrap ignore"><a href="#" class="tooltip" title="This example is not tested">ⓘ</a><pre class="rust rust-example-rendered"><code><span class="attr">#[test]
</span><span class="kw">fn </span>set_key_basics() {
	new_test_ext(<span class="number">1</span>).execute_with(|| {
		<span class="comment">// A root `key` can change the root `key`
		</span><span class="macro">assert_ok!</span>(Sudo::set_key(RuntimeOrigin::signed(<span class="number">1</span>), <span class="number">2</span>));
		<span class="macro">assert_eq!</span>(Sudo::key(), <span class="prelude-val">Some</span>(<span class="number">2u64</span>));
	});

	new_test_ext(<span class="number">1</span>).execute_with(|| {
		<span class="comment">// A non-root `key` will trigger a `RequireSudo` error and a non-root `key` cannot change
		// the root `key`.
		</span><span class="macro">assert_noop!</span>(Sudo::set_key(RuntimeOrigin::signed(<span class="number">2</span>), <span class="number">3</span>), Error::&lt;Test&gt;::RequireSudo);
	});
}</code></pre></div>
<ol start="3">
<li>You can also make non-privileged calls using <code>sudo_as</code>.</li>
</ol>

<div class="example-wrap ignore"><a href="#" class="tooltip" title="This example is not tested">ⓘ</a><pre class="rust rust-example-rendered"><code><span class="attr">#[test]
</span><span class="kw">fn </span>sudo_as_emits_events_correctly() {
	new_test_ext(<span class="number">1</span>).execute_with(|| {
		<span class="comment">// Set block number to 1 because events are not emitted on block 0.
		</span>System::set_block_number(<span class="number">1</span>);

		<span class="comment">// A non-privileged function will work when passed to `sudo_as` with the root `key`.
		</span><span class="kw">let </span>call = Box::new(RuntimeCall::Logger(LoggerCall::non_privileged_log {
			i: <span class="number">42</span>,
			weight: Weight::from_parts(<span class="number">1</span>, <span class="number">0</span>),
		}));
		<span class="macro">assert_ok!</span>(Sudo::sudo_as(RuntimeOrigin::signed(<span class="number">1</span>), <span class="number">2</span>, call));
		System::assert_has_event(TestEvent::Sudo(Event::SudoAsDone { sudo_result: <span class="prelude-val">Ok</span>(()) }));
	});
}</code></pre></div>
<h3 id="low-level--implementation-details"><a href="#low-level--implementation-details">Low Level / Implementation Details</a></h3>
<p>This pallet checks that the caller of its dispatchables is a signed account and ensures that the
caller matches the sudo key in storage.
A caller of this pallet’s dispatchables does not pay any fees to dispatch a call. If the account
making one of these calls is not the sudo key, the pallet returns a <a href="pallet/enum.Error.html#variant.RequireSudo" title="variant pallet_sudo::pallet::Error::RequireSudo"><code>Error::RequireSudo</code></a>
error.</p>
<p>Once an origin is verified, sudo calls use <code>dispatch_bypass_filter</code> from the
<a href="../frame_support/traits/dispatch/trait.UnfilteredDispatchable.html" title="trait frame_support::traits::dispatch::UnfilteredDispatchable"><code>UnfilteredDispatchable</code></a> trait to allow call
execution without enforcing any further origin checks.</p>
</div></details><h2 id="reexports" class="small-section-header"><a href="#reexports">Re-exports</a></h2><ul class="item-table"><li><div class="item-name" id="reexport.WeightInfo"><code>pub use weights::<a class="trait" href="weights/trait.WeightInfo.html" title="trait pallet_sudo::weights::WeightInfo">WeightInfo</a>;</code></div></li><li><div class="item-name"><code>pub use <a class="mod" href="pallet/index.html" title="mod pallet_sudo::pallet">pallet</a>::*;</code></div></li></ul><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="pallet/index.html" title="mod pallet_sudo::pallet">pallet</a></div><div class="desc docblock-short">The <code>pallet</code> module in each FRAME pallet hosts the most important items needed
to construct this pallet.</div></li><li><div class="item-name"><a class="mod" href="weights/index.html" title="mod pallet_sudo::weights">weights</a></div><div class="desc docblock-short">Autogenerated weights for pallet_sudo.</div></li></ul><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.CheckOnlySudoAccount.html" title="struct pallet_sudo::CheckOnlySudoAccount">CheckOnlySudoAccount</a></div><div class="desc docblock-short">Ensure that signed transactions are only valid if they are signed by sudo account.</div></li></ul></section></div></main></body></html>